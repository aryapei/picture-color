{"version":3,"sources":["data.js","img/line.jpg","img/download.svg","img/upload.svg","img/hint_eraser.svg","img/hint_paint.svg","img/hint_redo.svg","img/hint_undo.svg","img/cursor_brush_s.cur","img/cursor_eraser_s.cur","App.js","serviceWorker.js","index.js"],"names":["presetColors","imgs","line","require","download","upload","eraser","paint","redo","undo","curBrush","curEraser","circles","width","circleSize","circleSpacing","canvas","height","module","exports","data","defaultColor","lineWidth","eraseRadius","App","fillCanvasByImg","ctx","img","imgObj","Image","src","onload","drawImage","setColors","color","currentUsedColors","state","colors","index","indexOf","hex","splice","unshift","setState","setCurrentTool","tool","currentTool","displayColorPicker","getCurrentPoint","event","current","rect","getBoundingClientRect","x","clientX","left","y","clientY","top","onMouseDown","currentPoint","beginPath","moveTo","isOperating","prevPoint","onMouseUp","currentStep","historyCanvas","length","temp","push","toDataURL","ctx2","canvas2","onMouseMove","strokeStyle","lineTo","stroke","x1","y1","x2","y2","a","save","arc","Math","PI","clip","clearRect","restore","asin","sin","atan","acos","cos","x3","y3","x4","y4","x5","y5","x6","y6","closePath","canvasUndo","canvasRedo","downloadImg","imgData","format","multiplier","blob","substr","dataURLtoBlob","objurl","URL","createObjectURL","link","document","createElement","Date","valueOf","href","body","appendChild","click","removeChild","uploadImg","inputObj","file","getElementById","files","test","type","alert","reader","FileReader","readAsDataURL","me","e","initCanvas","this","result","dataurl","arr","split","mime","match","bstr","atob","n","u8arr","Uint8Array","charCodeAt","Blob","React","createRef","getContext","currentColor","cursorImg","className","ref","style","cursor","onClick","alt","id","accept","onChange","visible","background","disableAlpha","onChangeComplete","Component","Boolean","window","location","hostname","ReactDOM","render","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.084768ff.chunk.js","sourcesContent":["// 调色板下方的自定义色块\nexport const presetColors = [\n\"#2F4F4F\", \"#708090\", \"#778899\", \"#696969\", \"#A9A9A9\", \"#D3D3D3\", \"#DCDCDC\", \"#B0C4DE\", \"#00008B\", \"#191970\", \n\"#483D8B\", \"#4B0082\", \"#0000CD\", \"#7B68EE\", \"#4169E1\", \"#6495ED\", \"#008BBB\", \"#4682B4\", \"#1E90FF\", \"#00BFFF\",\n\"#87CEFA\", \"#87CEEB\", \"#ADD8E6\", \"#00FFFF\", \"#5F9EA0\", \"#20B2AA\", \"#66CDAA\", \"#00CED1\", \"#48D1CC\", \"#40E0D0\",\n\"#B0E0E6\", \"#AFEEEE\", \"#6B8E23\", \"#556B2F\", \"#006400\", \"#228B22\", \"#2E8B57\", \"#3CB371\", \"#32CD32\", \"#9ACD32\",\n\"#7FFFD4\", \"#00FA9A\", \"#00FF7F\", \"#7CFC00\", \"#7FFF00\", \"#ADFF2F\", \"#90EE90\", \"#98FB98\", \"#8B008B\", \"#6A5ACD\",\n\"#8A2BE2\", \"#9400D3\", \"#9932CC\", \"#BA55D3\", \"#9370DB\", \"#8FBC8F\", \"#8B0000\", \"#8B4513\", \"#A52A2A\", \"#B22222\",\n\"#A0522D\", \"#CD5C5C\", \"#D2691E\", \"#BDB76B\", \"#DC143C\", \"#FF1493\", \"#FF69B4\", \"#FF00FF\", \"#DA70D6\", \"#EE82EE\",\n\"#DDA0DD\", \"#D8BfD8\", \"#BC8F8F\", \"#C71585\", \"#DB7093\", \"#E9967A\", \"#F08080\", \"#FFA07A\", \"#FFB6C1\", \"#FFC0CB\",\n\"#FF4500\", \"#FF6347\", \"#FF4F50\", \"#FA8072\", \"#FF8C00\", \"#FFA500\", \"#F4A460\", \"#E6E6FA\", \"#B8860B\", \"#CD853F\",\n\"#DAA520\", \"#D2B48C\", \"#DEB887\", \"#FFD700\", \"#FFE4E1\", \"#E0FFFF\", \"#F0E68C\", \"#EEE8AA\", \"#FAFAD2\", \"#FFFACD\",\n\"#F5F5DC\", \"#FFF8DC\", \"#FFFFE0\", \"#FFDAB9\", \"#F5DEB3\", \"#FFDEAD\", \"#FFE4B5\", \"#FFE4C4\", \"#FFEBCD\", \"#FFEFD5\",\n\"#FAEBD7\", \"#FFF0F5\", \"#F0DDC3\", \"#EAB69C\", \"#F0DDD0\", \"#F7CEB5\", \"#EEBB99\", \"#F0D0B6\", \"#EAA98F\", \"#DDA98F\",\n\"#F7D9D6\", \"#E2C7B3\", \"#F7C39C\", \"#DDA982\", \"#EAD0B6\", \"#F0BAAD\", \"#A6958D\", \"#F0DDB6\", \"#EAC3A9\", \"#D4806B\",\n\"#9E8B82\", \"#EAB68F\", \"#F7D0C3\", \"#F7B69C\", \"#EBB285\", \"#F7C3A9\", \"#F7D0B6\", \"#F0C3A9\", \"#C3744D\", \"#F0D0A9\",\n\"#EAC3B6\", \"#F0A982\", \"#452A1D\", \"#F7D0A9\", \"#F7DDC3\", \"#F0B68F\", \"#ECDDCA\", \"#F9F9F9\"\n]\n\nexport const imgs = {\n\tline: require(\"./img/line.jpg\"),\n\tdownload: require(\"./img/download.svg\"),\n\tupload: require(\"./img/upload.svg\"),\n\teraser: require(\"./img/hint_eraser.svg\"),\n\tpaint: require(\"./img/hint_paint.svg\"),\n\tredo: require(\"./img/hint_redo.svg\"),\n\tundo: require(\"./img/hint_undo.svg\"),\n\tcurBrush: require(\"./img/cursor_brush_s.cur\"),\n\tcurEraser: require(\"./img/cursor_eraser_s.cur\"),\n}\n\nexport const circles = {\n  width: '63px',\n  circleSize: 17,\n  circleSpacing: 4\n}\n\nexport const canvas = {\n  width: 1000,\n  height: 1000,\n}","module.exports = __webpack_public_path__ + \"static/media/line.0fa4b773.jpg\";","module.exports = __webpack_public_path__ + \"static/media/download.02a1ddf8.svg\";","module.exports = __webpack_public_path__ + \"static/media/upload.b2ea1bd9.svg\";","module.exports = __webpack_public_path__ + \"static/media/hint_eraser.1436a7ca.svg\";","module.exports = __webpack_public_path__ + \"static/media/hint_paint.7f731611.svg\";","module.exports = __webpack_public_path__ + \"static/media/hint_redo.d976e955.svg\";","module.exports = __webpack_public_path__ + \"static/media/hint_undo.7abd66e6.svg\";","module.exports = __webpack_public_path__ + \"static/media/cursor_brush_s.d5e1d43e.cur\";","module.exports = __webpack_public_path__ + \"static/media/cursor_eraser_s.86d045f5.cur\";","import React from 'react';\nimport './App.css';\nimport { SketchPicker } from 'react-color';\nimport { CirclePicker } from 'react-color';\nconst data = require('./data.js');\nconst defaultColor = 'pink';\nconst lineWidth = 8;\nconst eraseRadius = 8;\n\nclass App extends React.Component {\n  constructor(){\n      super();\n      this.canvas = React.createRef();  // 上层canvas\n      this.canvas2 = React.createRef(); // 下层canvas背景\n      this.isOperating = false;         // 区分鼠标滑动还是在操作（上色或者擦除），鼠标按下开启，鼠标松开关闭\n      this.prevPoint = null;            // { x: , y: }\n      this.historyCanvas = [];        // [canvas1, canvas2]\n      this.state = {\n        currentTool: 'pen',             // 'pen' or 'eraser'\n        displayColorPicker: false,      // 是否展示颜色选择器\n        colors: [],                     // 记录所有选中过的颜色，其中colors[0]总是为当前选中颜色\n        currentStep: -1\n      };\n  }\n\n  // 在组件挂载后（插入 DOM 树中）立即调用，用来初始化页面\n  componentDidMount() {\n    // 声明两个全局变量\n    this.ctx = this.canvas.current.getContext('2d');\n    this.ctx2 = this.canvas2.current.getContext('2d');\n    // 渲染线图&初始化数据\n    this.initCanvas(data.imgs.line)\n  }\n\n  initCanvas(img){\n    this.img = img;\n    this.fillCanvasByImg(this.ctx, this.img);\n    this.fillCanvasByImg(this.ctx2, this.img);\n\n    this.historyCanvas=[];\n    this.historyCanvas.push(this.img);\n    this.state.currentStep=0;\n  }\n\n  // 给canvas绘制图片\n  fillCanvasByImg = (ctx, img) => {\n    var imgObj = new Image();\n    imgObj.src = img;\n    // imgObj.setAttribute(\"crossOrigin\",'Anonymous')\n    imgObj.onload = function(){\n      ctx.drawImage(imgObj, 0, 0, data.canvas.width, data.canvas.height);\n    }\n  }\n\n  setColors = (color) => {\n    var currentUsedColors = this.state.colors;\n    var index = currentUsedColors.indexOf(color.hex);\n    // 如果该颜色存在，从数组中删除它\n    if(index >= 0){\n      currentUsedColors.splice(index, 1)\n    }\n    // 从数组开头插入该颜色\n    currentUsedColors.unshift(color.hex)\n    // 更新视图\n    this.setState({ colors: currentUsedColors })\n  }\n\n  setCurrentTool = (tool) => {\n    this.setState({ currentTool: tool })\n  }\n\n  displayColorPicker = () => {\n    this.setState({ displayColorPicker: !this.state.displayColorPicker })\n  };\n\n  getCurrentPoint = (event) => {\n    var canvas = this.canvas.current;\n    var rect = canvas.getBoundingClientRect();\n    var x = (event.clientX - rect.left) * (canvas.width/rect.width);\n    var y = (event.clientY - rect.top) * (canvas.height/rect.height);\n\n    return { x: x, y: y}\n  }\n\n  onMouseDown = (event) => {\n    var currentPoint = this.getCurrentPoint(event);\n    this.ctx.beginPath();\n    this.ctx.moveTo(currentPoint.x, currentPoint.y);\n\n    this.isOperating = true;\n    // 记录第一个坐标点\n    this.prevPoint = currentPoint;\n  }\n\n  onMouseUp = (event) => {\n    this.isOperating = false;\n    this.prevPoint = null;\n\n    if(this.state.currentStep != this.historyCanvas.length-1){\n      let temp = this.historyCanvas[this.state.currentStep];\n      this.historyCanvas = [];\n      this.historyCanvas.push(temp);\n      this.state.currentStep = 0;\n    }\n\n    var img = null;\n    if(this.state.currentTool === 'pen'){\n      img = this.canvas.current.toDataURL();\n    }else if(this.state.currentTool === 'eraser'){\n      this.ctx2.drawImage(this.canvas.current, 0, 0);\n      img = this.canvas2.current.toDataURL();\n      // 合成完毕还原canvas2\n      this.fillCanvasByImg(this.ctx2, this.img)\n    }\n    this.state.currentStep++;\n    this.historyCanvas.push(img)\n    this.setState({ currentStep: this.state.currentStep });\n  }\n\n  onMouseMove = (event) => {\n    if(!this.isOperating) return;\n    var currentPoint = this.getCurrentPoint(event)\n  \n    if(this.state.currentTool === 'pen'){\n      //画笔\n      this.ctx.strokeStyle = this.state.colors[0] || defaultColor;\n      this.ctx.lineWidth = lineWidth;\n      this.ctx.lineTo(currentPoint.x, currentPoint.y);\n      this.ctx.stroke();\n    }else if(this.state.currentTool === 'eraser' && this.prevPoint){\n      //橡皮\n      var x1 = this.prevPoint.x;\n      var y1 = this.prevPoint.y;\n      var x2 = currentPoint.x;\n      var y2 = currentPoint.y;\n      var a = eraseRadius;\n\n      //保证线条的连贯，所以在矩形一端画圆擦除\n      this.ctx.save()\n      this.ctx.beginPath()\n      this.ctx.arc(x2,y2,a,0,2*Math.PI);\n      this.ctx.clip()\n      this.ctx.clearRect(0,0,this.canvas.current.width,this.canvas.current.height);\n      this.ctx.restore();\n\n      // 确定矩形区域的四个顶点\n      var asin = a*Math.sin(Math.atan((y2-y1)/(x2-x1)));\n      var acos = a*Math.cos(Math.atan((y2-y1)/(x2-x1)));\n      var x3 = x1+asin;\n      var y3 = y1-acos;\n      var x4 = x1-asin;\n      var y4 = y1+acos;\n      var x5 = x2+asin;\n      var y5 = y2-acos;\n      var x6 = x2-asin;\n      var y6 = y2+acos;\n\n　　　 //清除矩形剪辑区域里的像素\n      this.ctx.save()\n      this.ctx.beginPath()\n      this.ctx.moveTo(x3,y3);\n      this.ctx.lineTo(x5,y5);\n      this.ctx.lineTo(x6,y6);\n      this.ctx.lineTo(x4,y4);\n      this.ctx.closePath();\n      this.ctx.clip()\n      this.ctx.clearRect(0,0,this.canvas.current.width,this.canvas.current.height);\n      this.ctx.restore();\n    }\n\n    this.prevPoint = currentPoint;\n  }\n\n  canvasUndo = () => {\n    if(this.state.currentStep <= 0) return;\n    let img = this.historyCanvas[--this.state.currentStep];\n    this.fillCanvasByImg(this.ctx, img)\n    this.setState({ currentStep: this.state.currentStep });\n  }\n\n  canvasRedo = () => {\n    if(this.state.currentStep >= this.historyCanvas.length-1) return;\n    let img = this.historyCanvas[++this.state.currentStep];\n    this.fillCanvasByImg(this.ctx, img);\n    this.setState({ currentStep: this.state.currentStep });\n  }\n\n  downloadImg = () => {\n    // 合并两个canvas到canvas2\n    this.ctx2.drawImage(this.canvas.current, 0, 0);\n    var imgData = this.canvas2.current.toDataURL({format: 'png', multiplier: 4});\n    var strDataURI = imgData.substr(22, imgData.length);\n    var blob = this.dataURLtoBlob(imgData);\n    var objurl = URL.createObjectURL(blob);\n    // 合成完毕还原canvas2\n    this.fillCanvasByImg(this.ctx2, this.img)\n    \n    // 下载图片\n    var link = document.createElement('a');\n    link.download = \"picture-color\" + new Date().valueOf() + \".png\";\n    link.href = objurl;\n\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  }\n\n  uploadImg = (inputObj) => {\n    var file = document.getElementById('files').files[0];//获取input输入的图片\n    if(!/image\\/\\w+/.test(file.type)){\n        alert(\"请确保文件为图像类型\");\n        return false;\n    }//判断是否图片，在移动端由于浏览器对调用file类型处理不同，虽然加了accept = 'image/*'，但是还要再次判断\n    var reader = new FileReader();\n    reader.readAsDataURL(file);//转化成base64数据类型\n    let me = this;\n    reader.onload = function(e){\n        me.initCanvas(this.result);\n        // 不要忘了更新视图\n        me.setState({currentStep: me.state.currentStep})\n    }\n  }\n\n  dataURLtoBlob = (dataurl) => {\n    var arr = dataurl.split(','), mime = arr[0].match(/:(.*?);/)[1],\n      bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);\n    while(n--){\n      u8arr[n] = bstr.charCodeAt(n);\n    }\n    return new Blob([u8arr], {type:mime});\n  }\n\n  render() {\n    // 当前画笔的颜色\n    const currentColor = this.state.colors[0] || defaultColor;\n    \n    // 鼠标在图片上移动显示的图案，为画笔或者橡皮\n    var cursorImg = '';\n    if(this.state.currentTool === 'pen'){\n      cursorImg = data.imgs.curBrush;\n    }else if(this.state.currentTool === 'eraser'){\n      cursorImg = data.imgs.curEraser;\n    }\n\n    return (\n      <div className=\"App\">\n          <canvas className=\"under-layer\"\n            ref={ this.canvas2 } \n            width={ data.canvas.width }\n            height={ data.canvas.height }\n          >\n            您的浏览器不支持canvas，请更换浏览器.\n          </canvas>\n          <canvas className=\"upper-layer\"\n            ref={ this.canvas } \n            width={ data.canvas.width }\n            height={ data.canvas.height }\n            onMouseDown={ this.onMouseDown }\n            onMouseUp={ this.onMouseUp }\n            onMouseMove={ this.onMouseMove }\n            style={{cursor:  'url(' + `${cursorImg}` + '),auto'}}\n          >\n            您的浏览器不支持canvas，请更换浏览器.\n          </canvas>\n\n          <div className=\"bottom-tools\">\n            <button onClick={ () => document.getElementById(\"files\").click() }>\n              <img src={ data.imgs.upload } alt=\"upload\" />\n              <span>上传其他图像</span>\n            </button>\n            <input id=\"files\" type=\"file\" accept=\"image/*\" \n                   onChange={ this.uploadImg }\n                   style={{width: '0.01px', height: '0.01px', visible: 'hidden'}}/>\n            <button onClick={ this.downloadImg }>\n              <img src={ data.imgs.download } alt=\"download\"/>\n              <span>下载</span>\n            </button>\n         </div>\n\n         <div className=\"right-tools\">\n            <div className=\"common-tools\">\n              <button className={ this.state.currentStep <= 0? 'disabled': null } onClick={ this.canvasUndo }><img src={ data.imgs.undo } alt=\"undo\"/></button>\n              <button className={ this.state.currentStep >= this.historyCanvas.length-1? 'disabled': null } onClick={ this.canvasRedo }><img src={ data.imgs.redo } alt=\"redo\"/></button> \n            </div>\n            <div className=\"color-tools\">\n              <div className=\"current-color-container\" onClick={ this.displayColorPicker }>\n                <div className=\"current-color\" style={{background: `${currentColor}`}} />\n              </div>\n              <CirclePicker width={ data.circles.width } circleSize={ data.circles.circleSize } circleSpacing={ data.circles.circleSpacing } colors={ this.state.colors } onChange={ this.setColors }/>\n              { \n                this.state.displayColorPicker ? \n                  <div className=\"popover\">\n                    <SketchPicker \n                      disableAlpha={ true }\n                      presetColors={ data.presetColors } \n                      color={ currentColor }\n                      onChangeComplete={ this.setColors }\n                    />\n                  </div> \n                : null \n              }\n            </div>\n            <div className=\"toolbox\">\n              <button onClick={ () => this.setCurrentTool('pen') }><img className={ this.state.currentTool==='pen'? 'active': null } src={ data.imgs.paint } alt=\"pen\" /></button>\n              <button onClick={ () => this.setCurrentTool('eraser') }><img className={ this.state.currentTool==='eraser'? 'active': null } src={ data.imgs.eraser } alt=\"eraser\" /></button>\n            </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}